{
    "version": "https://jsonfeed.org/version/1",
    "title": "宝硕博客 • All posts by \"ctf\" tag",
    "description": "宝硕博客 —— Baoshuo (@renbaoshuo) 随便写东西的地方，以技术向博文为主，生活向博文为辅。",
    "home_page_url": "https://blog.baoshuo.ren",
    "items": [
        {
            "id": "https://blog.baoshuo.ren/post/ustc-hackergame-2020-write-up/",
            "url": "https://blog.baoshuo.ren/post/ustc-hackergame-2020-write-up/",
            "title": "USTC Hackergame 2020 Write Up",
            "date_published": "2020-10-31T08:36:28.000Z",
            "content_html": "<h2 id=\"前言\"><a class=\"anchor\" href=\"#前言\"></a>前言</h2>\n<p>对于我这种啥也不会的蒟蒻，拿到第676名已经是很不错的了（逃</p>\n<span id=\"more\"></span>\n<h2 id=\"web\"><a class=\"anchor\" href=\"#web\"></a>web</h2>\n<h3 id=\"签到题\"><a class=\"anchor\" href=\"#签到题\"></a>签到题</h3>\n<p>web题当然要先看源码了（出题人好恶毒啊）</p>\n<p><img src=\"https://vip1.loli.io/2020/11/25/FqvWiXe4DIzLnr3.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>再就是改值、提交</p>\n<p><img src=\"https://vip1.loli.io/2020/11/25/dnqM5sTKEQlIC9w.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>so easy~</p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/8kSKomN217XJUEY.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>flag 获取成功：<code>flag&#123;hR6Ku81-HappyHacking2020-35a790fff0&#125;</code></p>\n<h3 id=\"2048\"><a class=\"anchor\" href=\"#2048\"></a>2048</h3>\n<p>首先F12看下源码，看到了一个有趣的东西</p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/dJXolhVqNvwSPjs.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p><s>这么好的东西当然要拖到console里面去啊</s></p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/bsvZc4H8D2JWBAz.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<blockquote>\n<p>小彩蛋：JavaScript 中 String 类型转换成数字类型时会得到 <code>NaN</code>，凑成了 <code>banana</code> 。</p>\n</blockquote>\n<p>然后就出来了此题的 「flxg」</p>\n<p><img src=\"https://vip1.loli.io/2020/11/25/Nf5gw3cM8opAQ9U.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>flxg获取成功：<code>flxg&#123;8G6so5g-FLXG-7b77994fc5&#125;</code></p>\n<h2 id=\"general\"><a class=\"anchor\" href=\"#general\"></a>general</h2>\n<h3 id=\"一闪而过的-flag\"><a class=\"anchor\" href=\"#一闪而过的-flag\"></a>一闪而过的 Flag</h3>\n<p>直接打开是会闪，但是，你闪归你闪，我直接用cmd打开，你总不能 <s>把我cmd窗口关掉吧</s> 还继续闪吧</p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/KavlGwSQoVqi4PZ.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>flag获取成功：<code>flag&#123;Are_you_eyes1ght_g00D?_can_you_dIst1nguish_1iI?&#125;</code></p>\n<h3 id=\"猫咪问答\"><a class=\"anchor\" href=\"#猫咪问答\"></a>猫咪问答++</h3>\n<blockquote>\n<ol start=\"2\">\n<li>第一个以信鸽为载体的 IP 网络标准的 RFC 文档中推荐使用的 MTU (Maximum Transmission Unit) 是多少毫克？</li>\n</ol>\n</blockquote>\n<p>这个很好找，链接奉上：<a href=\"https://tools.ietf.org/html/rfc1149\">https://tools.ietf.org/html/rfc1149</a></p>\n<blockquote>\n<ol start=\"3\">\n<li>USTC Linux 用户协会在 2019 年 9 月 21 日自由软件日活动中介绍的开源游戏的名称共有几个字母？</li>\n</ol>\n</blockquote>\n<p><s>谷歌一下，你就知道</s> <a href=\"https://news.ustclug.org/2019/09/2019-sfd-ustc/\">https://news.ustclug.org/2019/09/2019-sfd-ustc/</a></p>\n<blockquote>\n<ol start=\"5\">\n<li>中国科学技术大学第六届信息安全大赛所有人合计提交了多少次 flag？</li>\n</ol>\n</blockquote>\n<p><img src=\"https://vip2.loli.io/2020/11/25/t3di51gVr2R7yvS.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>至于剩下的… 懒得找了，直接暴力吧</p>\n<blockquote>\n<ol>\n<li>以下编程语言、软件或组织对应标志是哺乳动物的有几个？\nDocker，Golang，Python，Plan 9，PHP，GNU，LLVM，Swift，Perl，GitHub，TortoiseSVN，FireFox，MySQL，PostgreSQL，MariaDB，Linux，OpenBSD，FreeDOS，Apache Tomcat，Squid，openSUSE，Kali，Xfce.</li>\n</ol>\n</blockquote>\n<blockquote>\n<ol start=\"4\">\n<li>中国科学技术大学西校区图书馆正前方（西南方向） 50 米 L 型灌木处共有几个连通的划线停车位？</li>\n</ol>\n</blockquote>\n<p><img src=\"https://vip2.loli.io/2020/11/25/7YmcOir9tS5xZ28.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>附上代码：</p>\n<pre><code class=\"highlight bash\"><span class=\"keyword\">for</span>((i=1;i&lt;=23;i=(<span class=\"variable\">$i</span>+1))); <span class=\"keyword\">do</span> <span class=\"keyword\">for</span>((j=1;j&lt;=30;j=(<span class=\"variable\">$j</span>+1))); <span class=\"keyword\">do</span> <span class=\"built_in\">echo</span> <span class=\"string\">&quot;[<span class=\"variable\">$i</span>, <span class=\"variable\">$j</span>] <span class=\"subst\">$(curl -s &#x27;http://202.38.93.111:10001/&#x27; --data <span class=\"string\">&quot;q1=<span class=\"variable\">$i</span>&amp;q2=256&amp;q3=9&amp;q4=<span class=\"variable\">$j</span>&amp;q5=17098&quot;</span> -H <span class=\"string\">&quot;Cookie: PHPSESSID=******; session=******&quot;</span> | grep &#x27;flag.*&#x27;)</span>&quot;</span> ; <span class=\"keyword\">done</span> ; <span class=\"keyword\">done</span></code></pre>\n<p>flag获取成功：<code>flag&#123;b4a31f2a_G00G1e_1s_y0ur_fr13nd_228b608a32&#125;</code></p>\n<h3 id=\"233-同学的-docker\"><a class=\"anchor\" href=\"#233-同学的-docker\"></a>233 同学的 Docker</h3>\n<p><img src=\"https://vip2.loli.io/2020/11/25/pP5dvYI8Tz49QLB.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>众所周知，Docker 镜像是分层存储的，所以这道题可以很轻松地解出来。</p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/im2bTZqAMNJPf5d.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>先pull下来镜像。</p>\n<pre><code class=\"highlight shell\">docker inspect 8b8d3c8324c7/stringtool</code></pre>\n<p>然后查看镜像的元信息，下面是简化版的结果（json格式）</p>\n<pre><code class=\"highlight json\">[\n    &#123;\n        <span class=\"attr\">&quot;Id&quot;</span>: <span class=\"string\">&quot;sha256:be6d023618d199e0ec7448f70e5e47a00c6c2b79777ad5e2d312a6f74d6ad56b&quot;</span>,\n        <span class=\"attr\">&quot;RepoTags&quot;</span>: [\n            <span class=\"string\">&quot;8b8d3c8324c7/stringtool:latest&quot;</span>\n        ],\n        <span class=\"attr\">&quot;RepoDigests&quot;</span>: [\n            <span class=\"string\">&quot;8b8d3c8324c7/stringtool@sha256:aef87a00ad7a4e240e4b475ea265d3818c694034c26ec227d8d4f445f3d93152&quot;</span>\n        ],\n        <span class=\"attr\">&quot;Parent&quot;</span>: <span class=\"string\">&quot;&quot;</span>,\n        <span class=\"attr\">&quot;Comment&quot;</span>: <span class=\"string\">&quot;&quot;</span>,\n        <span class=\"attr\">&quot;Created&quot;</span>: <span class=\"string\">&quot;2020-10-16T12:51:09.221320098Z&quot;</span>,\n        <span class=\"attr\">&quot;Container&quot;</span>: <span class=\"string\">&quot;d2f452fddd5c71c8c57a29d67f29c69ffac419440d57664dad6e4ba1f0eff8a1&quot;</span>,\n        <span class=\"attr\">&quot;GraphDriver&quot;</span>: &#123;\n            <span class=\"attr\">&quot;Data&quot;</span>: &#123;\n                <span class=\"attr\">&quot;LowerDir&quot;</span>: <span class=\"string\">&quot;/var/lib/docker/overlay2/e5ae9d16844b8a8f5a943dec4172e04f6cdd283af181e1d17315c6b4df883eb1/diff:/var/lib/docker/overlay2/e394091d4d369e4b39d51389ada0156f8df91164e7928ca705321012b3164171/diff:/var/lib/docker/overlay2/de25217d9ac38b566f5e21050325fc0b712b81eb76d8bf949535efe4048150dc/diff:/var/lib/docker/overlay2/44b1b520904edb80dde2e1cfd0bb4e8cc272bcdb3abfbecb9f7c58c66fda461f/diff:/var/lib/docker/overlay2/77e74c48f3d794c594fcbbaafb1de3de084d5680c7361eb3c694cd74bb5ba7d2/diff:/var/lib/docker/overlay2/e2f50b5ba8b187a859f175daf953b5f1244ca210e65fc281cebbb490c1736090/diff:/var/lib/docker/overlay2/c49ab73078dbf960574fba1cb22cbfa6cb80300213ef9ce0e8541204181b2ea6/diff:/var/lib/docker/overlay2/cdca87b3621cb3bafbb198f6b90aa229e225eec78f0a58b0b17415bc0c252c3c/diff:/var/lib/docker/overlay2/c75c733f9469403b6677b86de747b78eee86b342e4b8cb67301b62bc37148f0d/diff:/var/lib/docker/overlay2/6c5b7e0fcab90d5b9e95987fa4901fdaca167e20078efc15255025edaa3bffe5/diff:/var/lib/docker/overlay2/15ec67c13cb10d0efe49ffa8038af1e4e15ee4ace3d0e3cbb3b35373438162ee/diff:/var/lib/docker/overlay2/63919ff473de17fc4a04bebe8e3163ac9a6615e860c8d154c58b40e83cae3008/diff:/var/lib/docker/overlay2/301804bb5ea02f0be82935af0838aae81fb796470e35ca799c010ee551c63901/diff:/var/lib/docker/overlay2/837182ab20cd4356c084efceb23eaf81921b199deeb4260a3bb8bd3690bdf248/diff:/var/lib/docker/overlay2/83f0cdea53e8d31281de36413a4d5e5ba9aef2fce54733ab8686bdc04a0c7736/diff:/var/lib/docker/overlay2/fad7f08992db8ca5ee5d731ccc21ac6746107798714b453e6fb21f23f0de8ed6/diff:/var/lib/docker/overlay2/2742f86c6ff24a479ff553458418cee16e1d90c3ba6e51f28599fcd2143108c0/diff:/var/lib/docker/overlay2/f0ea5cad64532fdff5edaaad4880132a8811bbd04019a2b216710dfda4bb829b/diff:/var/lib/docker/overlay2/af49c2f259440c1d94b6843258a68201bb3a37b6ec0e20b7e1dc6773de29e5eb/diff:/var/lib/docker/overlay2/9d6591c82c88ba3d461cf4d20c03e2a4b064454e3bbe9718b26e97eaf1fa703b/diff:/var/lib/docker/overlay2/eb71979f0abedbf4854bd95a364726dd7dc21b779512dad582bdefe87b24efb3/diff:/var/lib/docker/overlay2/b14870a3b3e75ac73506b96ad8de3ac918b6d1dbb8cb702e56b1d879910ee8d7/diff&quot;</span>,\n                <span class=\"attr\">&quot;MergedDir&quot;</span>: <span class=\"string\">&quot;/var/lib/docker/overlay2/9d9609e4438067f4a2b0d26aeefab51a6e0abb58262e571b5fe2558955f271b7/merged&quot;</span>,\n                <span class=\"attr\">&quot;UpperDir&quot;</span>: <span class=\"string\">&quot;/var/lib/docker/overlay2/9d9609e4438067f4a2b0d26aeefab51a6e0abb58262e571b5fe2558955f271b7/diff&quot;</span>,\n                <span class=\"attr\">&quot;WorkDir&quot;</span>: <span class=\"string\">&quot;/var/lib/docker/overlay2/9d9609e4438067f4a2b0d26aeefab51a6e0abb58262e571b5fe2558955f271b7/work&quot;</span>\n            &#125;,\n            <span class=\"attr\">&quot;Name&quot;</span>: <span class=\"string\">&quot;overlay2&quot;</span>\n        &#125;\n    &#125;\n]</code></pre>\n<p>查看 diff 文件夹：</p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/IxlmEhSfRUPKy6G.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>然后就能看到文件内容了~</p>\n<p><img src=\"https://vip2.loli.io/2020/11/25/eLq2mSpCi68wVZQ.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>flag获取成功：<code>flag&#123;Docker_Layers!=PS_Layers_hhh&#125;</code></p>\n",
            "tags": [
                "CTF"
            ]
        },
        {
            "id": "https://blog.baoshuo.ren/post/bilibili-1024-ctf-write-up/",
            "url": "https://blog.baoshuo.ren/post/bilibili-1024-ctf-write-up/",
            "title": "Bilibili 1024 节 CTF Write Up",
            "date_published": "2020-10-26T10:02:08.000Z",
            "content_html": "<p>比赛地址： <a href=\"https://security.bilibili.com/sec1024/\">https://security.bilibili.com/sec1024/</a></p>\n<h2 id=\"t1：页面的背后是什么？\"><a class=\"anchor\" href=\"#t1：页面的背后是什么？\"></a>T1：页面的背后是什么？</h2>\n<p><s>F12解决一切问题</s></p>\n<p><img src=\"https://vip2.loli.io/2020/11/28/XrLpIf2OHs4YAxJ.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<h2 id=\"t2：真正的秘密只有特殊的设备才能看到\"><a class=\"anchor\" href=\"#t2：真正的秘密只有特殊的设备才能看到\"></a>T2：真正的秘密只有特殊的设备才能看到</h2>\n<p>改下UA就行了，轻松到手</p>\n<p><img src=\"https://vip2.loli.io/2020/11/28/WPLCUHNYiE2nFwJ.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p><img src=\"https://vip2.loli.io/2020/11/28/83GrjFbTwJf1BHn.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<h2 id=\"t3：密码是啥？\"><a class=\"anchor\" href=\"#t3：密码是啥？\"></a>T3：密码是啥？</h2>\n<p>看了看源码，没啥思路，最后随便试了试 <code>admin</code> <code>root</code> <code>bilibili</code> 什么的，竟然是对的。</p>\n<ul>\n<li>用户名 <code>admin</code></li>\n<li>密码 <code>bilibili</code></li>\n</ul>\n<p>另外，你告诉我什么是 <strong>falg</strong> ？</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/eg9kBtR1aQizGYE.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<h2 id=\"t4：对不起，权限不足～\"><a class=\"anchor\" href=\"#t4：对不起，权限不足～\"></a>T4：对不起，权限不足～</h2>\n<p>第一次访问：</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/roVjXTfs4v8ibP5.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>第二次访问：</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/RpEsGn8c9KY16MH.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>查看源码可以发现有个 API 请求，查看请求数据得到以下信息。</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/nhF7pCTQsVYxKdj.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>role里面的东西，贴进谷歌一搜就知道它是 <code>user</code> 的 MD5 。</p>\n<p>和超级管理员相关的名字相信大家都知道，无非就是 <code>admin</code> <code>Administrator</code> <code>root</code> 之类的东西。</p>\n<p>挨个试，最后发现 <code>Administrator</code> 是正确的。</p>\n<pre><code class=\"highlight shell\">curl &quot;http://45.113.201.36/api/ctf/4&quot; --cookie &quot;role=7b7bc2512ee1fedcd76bdc68926d4f7b; session=***;&quot;</code></pre>\n<p><img src=\"https://vip1.loli.io/2020/11/28/gEhkmTJrnaoMwPv.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<h2 id=\"t5：别人的秘密\"><a class=\"anchor\" href=\"#t5：别人的秘密\"></a>T5：别人的秘密</h2>\n<p><img src=\"https://vip1.loli.io/2020/11/28/c4BjYs3nVuCpxmH.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>发现有个API，还有个 UID。</p>\n<p>最开始没想到需要从代码里面的&quot;初始UID&quot;开始扫，浪费了我好多时间。</p>\n<pre><code class=\"highlight shell\">for ((i=100336889;$i&lt;9999999999;i=($i+1))); do echo -e &quot;[$i] \\c&quot; &amp;&amp; curl &quot;http://45.113.201.36/api/ctf/5?uid=$&#123;i&#125;&quot; -H &#x27;User-Agent: bilibili Security Browser&#x27; -H &#x27;Cookie: session=*****; role=ee11cbb19052e40b07aac0ca060c23ee&#x27; ; done</code></pre>\n<p><img src=\"https://vip1.loli.io/2020/11/28/m1Hr4u8FOJe7ycI.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<h2 id=\"t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～\"><a class=\"anchor\" href=\"#t6-t10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～\"></a>T6~T10：结束亦是开始，接下来的旅程，需要少年自己去探索啦～</h2>\n<p>先扫了扫端口，发现有个 redis</p>\n<p><img src=\"https://vip2.loli.io/2020/11/28/E29tLxSiC6Qzn5O.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<pre><code class=\"highlight shell\">redis-cli -h 120.92.151.189 -p 6379</code></pre>\n<p>登上去看看，发现了第八题的 flag 。</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/Oo5vyeEsChmSt2H.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>然后爆破下目录</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/QEnxZsg8FpiOKwm.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>有个 test.php ，访问下发现是个 JSfuck 加密，丢进浏览器里面解密下</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/G7TWPndrhqBmvAI.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>程序员最多的地方，那就肯定是 Github 了。</p>\n<p>然后找到了一个仓库 <a href=\"https://github.com/interesting-1024/end\">interesting-1024/end</a></p>\n<p>有个 <code>end.php</code></p>\n<pre><code class=\"highlight php\"><span class=\"meta\">&lt;?php</span>\n\n<span class=\"comment\">//filename end.php</span>\n\n<span class=\"variable\">$bilibili</span> = <span class=\"string\">&quot;bilibili1024havefun&quot;</span>;\n\n<span class=\"variable\">$str</span> = intval(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;id&#x27;</span>]);\n<span class=\"variable\">$reg</span> = preg_match(<span class=\"string\">&#x27;/\\d/is&#x27;</span>, <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;id&#x27;</span>]);\n\n<span class=\"keyword\">if</span>(!is_numeric(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;id&#x27;</span>]) <span class=\"keyword\">and</span> <span class=\"variable\">$reg</span> !== <span class=\"number\">1</span> <span class=\"keyword\">and</span> <span class=\"variable\">$str</span> === <span class=\"number\">1</span>)&#123;\n    <span class=\"variable\">$content</span> = file_get_contents(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;url&#x27;</span>]);\n    \n    <span class=\"comment\">//文件路径猜解</span>\n    <span class=\"keyword\">if</span> (<span class=\"literal\">false</span>)&#123;\n        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;还差一点点啦～&quot;</span>;\n    &#125;<span class=\"keyword\">else</span>&#123;\n        <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;\n    &#125;\n&#125;<span class=\"keyword\">else</span>&#123;\n    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;你想要的不在这儿～&quot;</span>;\n&#125;\n<span class=\"meta\">?&gt;</span></code></pre>\n<p>然后需要构造出一个 符合 <code>!is_numeric($_GET['id']) and preg_match('/\\d/is', $_GET['id']) !== 1 and intval($_GET['id']) === 1</code> 的请求即可。</p>\n<p><img src=\"https://vip1.loli.io/2020/11/28/mCIevr1HSMBpkdi.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>可以得到一个图片的链接 <code>http://45.113.201.36/blog/imgs/bilibili_224a634752448def6c0ec064e49fe797_havefun.jpg</code></p>\n<p><img src=\"https://vip2.loli.io/2020/11/28/iXEgYzjPtH2NhQw.png\" alt=\"\" loading=\"lazy\" data-action=\"zoom\"></p>\n<p>这个图片的末尾就是第十个 flag 了（图中标蓝的地方）。</p>\n",
            "tags": [
                "CTF"
            ]
        }
    ]
}